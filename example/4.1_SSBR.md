4.1\_SSBR
================
Tianjing Zhao
August 27, 2018

### Step 1: Load Package

``` r
library("JWASr")
```
Please make sure you've already set up.

### Step 2: Read data
``` r
phenotypes = phenotypes #build-in data
```
You can import your own data by [read.table()](https://www.rdocumentation.org/packages/utils/versions/3.5.1/topics/read.table).
``` r
ped_path = "D:\\JWASr\\data\\pedigree.txt"  #change to your local path
get_pedigree(ped_path, separator=',', header=T)  #build "pedigree" in Julia
```

### Step 3: Build Model Equations

``` r
model_equation = "y1 = intercept + x1*x3 + x2 + x3 + ID + dam"
R = 1.0

model = build_model(model_equation,R) #build "model" in Julia
```

### Step 4: Set Factors or Covariate

``` r
ran_julia('set_covariate(model,"x1")')
```


### Step 5: Set Random or Fixed Effects

``` r
G1 = 1.0
set_random("x2", G1)
```


``` r
G2 = diag(2)
set_random("ID dam", G2, pedigree = TRUE)
```


### Step 6: Use Genomic Information


``` r
G3 = 1.0
geno_path = "D:/JWASr/data/genotypes.txt"  #change to your local path

add_genotypes(geno_path, G3)  #separator=',' is default
```

### Step 7: Run

``` r
outputEBV(ai = c("a1","a2","a3"))
```

``` r
outputMCMCsamples("x2")
```

``` r
out = runMCMC(data = phenotypes, methods = "RR-BLUP",single_step_analysis = TRUE,
                     pedigree=TRUE, chain_length = 5000, output_samples_frequency = 100,outputEBV = TRUE)  
```

All results


``` r
out
```

    ## $`Posterior mean of polygenic effects covariance matrix`
    ##            [,1]       [,2]
    ## [1,] 1.04584885 0.01574001
    ## [2,] 0.01574001 1.05413896
    ## 
    ## $EBV_y1
    ##      [,1] [,2]      
    ## [1,] "a1" -2.753016 
    ## [2,] "a2" -0.7715506
    ## [3,] "a3" -2.711093 
    ## 
    ## $`Posterior mean of marker effects`
    ##      [,1] [,2]      
    ## [1,] "m1" -0.6269476
    ## [2,] "m2" -0.6222369
    ## [3,] "m3" 1.071518  
    ## [4,] "m4" 0.5445467 
    ## [5,] "m5" 0.6219504 
    ## 
    ## $`Posterior mean of residual variance`
    ## [1] 0.9221161
    ## 
    ## $`Posterior mean of marker effects variance`
    ## [1] 1.026718
    ## 
    ## $`Posterior mean of location parameters`
    ##    Trait    Effect     Level     Estimate
    ## 1      1 intercept intercept     10.36101
    ## 2      1     x1*x3    x1 * m      1.27034
    ## 3      1     x1*x3    x1 * f     1.158373
    ## 4      1        x2         2 -0.006773885
    ## 5      1        x2         1   0.08092469
    ## 6      1        x3         m    -9.047474
    ## 7      1        x3         f     -10.6316
    ## 8      1        ID        a2    0.1160863
    ## 9      1        ID       a12    0.1977274
    ## 10     1        ID       a10    0.4347511
    ## 11     1        ID       a11    0.2136436
    ## 12     1        ID        a9 -0.007509172
    ## 13     1        ID        a6  -0.06577388
    ## 14     1        ID        a7    0.1498906
    ## 15     1        ID        a3   0.01587147
    ## 16     1        ID        a8   -0.4033375
    ## 17     1        ID        a1    0.1024836
    ## 18     1        ID        a5    0.4067511
    ## 19     1        ID        a4   -0.1600385
    ## 20     1       dam        a2    0.1044293
    ## 21     1       dam       a12    -0.111887
    ## 22     1       dam       a10   0.01880324
    ## 23     1       dam       a11   -0.1129037
    ## 24     1       dam        a9   -0.2488175
    ## 25     1       dam        a6   -0.4397163
    ## 26     1       dam        a7   0.03824285
    ## 27     1       dam        a3   -0.1697207
    ## 28     1       dam        a8   -0.2358503
    ## 29     1       dam        a1   -0.1255868
    ## 30     1       dam        a5  -0.01529711
    ## 31     1       dam        a4  -0.02708873
    ## 32     1  <U+03F5>        a2   0.06427048
    ## 33     1  <U+03F5>       a12    0.1557461
    ## 34     1  <U+03F5>       a10    0.1831177
    ## 35     1  <U+03F5>       a11    0.1529095
    ## 36     1  <U+03F5>        a9     0.117013
    ## 37     1         J         J     2.912832

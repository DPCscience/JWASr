2.2\_Linear\_Additive\_Genetic\_Model
================
Tianjing Zhao
August 27, 2018

### set up (windows user)

``` r
path_libjulia = "C:/Users/ztjsw/AppData/Local/Julia-0.7.0/bin/libjulia.dll"
JWASr::jwasr_setup_win(path_libjulia)
```

    ## Julia version 0.7.0 at location C:\Users\ztjsw\AppData\Local\JULIA-~2.0\bin will be used.

    ## Loading setup script for JuliaCall...

    ## Finish loading setup script for JuliaCall.

For Mac user, run one line "JWASr::jwasr\_setup()" to setup.

### build model

``` r
model_equation ="y1 = intercept + x1 + x3 + ID + dam
                  y2 = intercept + x1 + x2 + x3 + ID
                  y3 = intercept + x1 + x1*x3 + x2 + ID"
R = diag(3)

model = JWASr::build_model(model_equation, R)  #build "model" in Julia
```

### data

``` r
phenotypes = JWASr::phenotypes

ped_path = "D:\\JWASr\\data\\pedigree.txt"
JWASr::get_pedigree(ped_path, separator=',', header=T)  #build "pedigree" in Julia
```

    ## JWAS.PedModule.Pedigree(13, Dict{AbstractString,JWAS.PedModule.PedNode}("a2"=>PedNode(1, "0", "0", 0.0),"a1"=>PedNode(2, "0", "0", 0.0),"a7"=>PedNode(4, "a1", "a3", 0.0),"a12"=>PedNode(10, "a9", "a10", 0.1875),"a5"=>PedNode(8, "a1", "a2", 0.0),"a3"=>PedNode(3, "0", "0", 0.0),"a4"=>PedNode(5, "a1", "a2", 0.0),"a6"=>PedNode(6, "a1", "a3", 0.0),"a10"=>PedNode(9, "a5", "a7", 0.125),"a11"=>PedNode(11, "a9", "a10", 0.1875)), Dict(32=>0.25,2=>0.0,16=>0.0,11=>0.5,7=>0.0,9=>0.5,25=>0.375,35=>0.375,43=>0.375,19=>0.5), Set(Any[]), Set(Any[]), Set(Any[]), Set(Any[]))

### set covariate

``` r
JWASr::ran_julia('set_covariate(model,"x1")')
```

    ## 1-element Array{Symbol,1}:
    ##  :x1

### set random

``` r
JWASr::assign("G1", diag(2))
JWASr::ran_julia('set_random(model,"x2",G1)')
```

``` r
JWASr::assign("G2",diag(4))
JWASr::ran_julia('set_random(model,"ID dam",pedigree,G2)')
```

### run

``` r
JWASr::ran_julia('outputMCMCsamples(model,"x2")')
out = JWASr::runMCMC(data = phenotypes, chain_length = 5000, output_samples_frequency = 100, outputEBV = TRUE)   
```

### select result "EBV\_y2"

``` r
out$EBV_y2
```

    ##       [,1]  [,2]       
    ##  [1,] "a2"  0.7571051  
    ##  [2,] "a1"  -0.5606095 
    ##  [3,] "a7"  -0.6894073 
    ##  [4,] "a12" -0.0836066 
    ##  [5,] "a5"  -1.020498  
    ##  [6,] "a3"  -0.09611039
    ##  [7,] "a4"  1.622911   
    ##  [8,] "a6"  0.4318617  
    ##  [9,] "a10" -1.901942  
    ## [10,] "a11" -0.09926179
    ## [11,] "a8"  1.913923   
    ## [12,] "a9"  1.707714

Or "out\[1\]"

### all results

``` r
out
```

    ## $EBV_y2
    ##       [,1]  [,2]       
    ##  [1,] "a2"  0.7571051  
    ##  [2,] "a1"  -0.5606095 
    ##  [3,] "a7"  -0.6894073 
    ##  [4,] "a12" -0.0836066 
    ##  [5,] "a5"  -1.020498  
    ##  [6,] "a3"  -0.09611039
    ##  [7,] "a4"  1.622911   
    ##  [8,] "a6"  0.4318617  
    ##  [9,] "a10" -1.901942  
    ## [10,] "a11" -0.09926179
    ## [11,] "a8"  1.913923   
    ## [12,] "a9"  1.707714   
    ## 
    ## $`Posterior mean of polygenic effects covariance matrix`
    ##             [,1]       [,2]       [,3]        [,4]
    ## [1,]  2.88653904 -1.8695384 -0.3419079 -0.06756291
    ## [2,] -1.86953844  2.3540182  0.3317515  0.05227950
    ## [3,] -0.34190789  0.3317515  0.8380980  0.03404260
    ## [4,] -0.06756291  0.0522795  0.0340426  1.08723885
    ## 
    ## $EBV_y1
    ##       [,1]  [,2]      
    ##  [1,] "a2"  0.4341928 
    ##  [2,] "a1"  0.187291  
    ##  [3,] "a7"  0.3209775 
    ##  [4,] "a12" 0.125704  
    ##  [5,] "a5"  1.838655  
    ##  [6,] "a3"  -0.6797229
    ##  [7,] "a4"  -1.454695 
    ##  [8,] "a6"  -1.20962  
    ##  [9,] "a10" 1.956294  
    ## [10,] "a11" 0.1892114 
    ## [11,] "a8"  -2.520774 
    ## [12,] "a9"  -1.660524 
    ## 
    ## $EBV_y3
    ##       [,1]  [,2]       
    ##  [1,] "a2"  0.1801575  
    ##  [2,] "a1"  -0.5563798 
    ##  [3,] "a7"  -0.5984525 
    ##  [4,] "a12" -0.1923312 
    ##  [5,] "a5"  -0.6344604 
    ##  [6,] "a3"  0.2665065  
    ##  [7,] "a4"  -0.1203474 
    ##  [8,] "a6"  -0.01068671
    ##  [9,] "a10" -0.7788087 
    ## [10,] "a11" -0.17068   
    ## [11,] "a8"  -0.1831543 
    ## [12,] "a9"  0.4088791  
    ## 
    ## $`Posterior mean of residual variance`
    ##              [,1]        [,2]         [,3]
    ## [1,]  1.278017345 -0.48972989 -0.002758652
    ## [2,] -0.489729886  1.12704249  0.050343166
    ## [3,] -0.002758652  0.05034317  0.810384792
    ## 
    ## $`Posterior mean of location parameters`
    ##    Trait    Effect     Level    Estimate
    ## 1      1 intercept intercept   -28.10241
    ## 2      1        x1        x1   0.6189452
    ## 3      1        x3         m    27.04992
    ## 4      1        x3         f    26.80816
    ## 5      1        ID        a2   0.1333965
    ## 6      1        ID        a1   0.2954627
    ## 7      1        ID        a3  -0.7711562
    ## 8      1        ID        a7     0.17823
    ## 9      1        ID        a4   -1.521614
    ## 10     1        ID        a6  -0.9528753
    ## 11     1        ID        a9   -1.637456
    ## 12     1        ID        a5     1.76805
    ## 13     1        ID       a10    1.923768
    ## 14     1        ID       a12   0.1221884
    ## 15     1        ID       a11   0.1593965
    ## 16     1        ID        a8   -2.464237
    ## 17     1       dam        a2   0.3007963
    ## 18     1       dam        a1  -0.1081718
    ## 19     1       dam        a3  0.09143326
    ## 20     1       dam        a7   0.1427476
    ## 21     1       dam        a4  0.06691841
    ## 22     1       dam        a6  -0.2567445
    ## 23     1       dam        a9 -0.02306811
    ## 24     1       dam        a5  0.07060507
    ## 25     1       dam       a10   0.0325263
    ## 26     1       dam       a12  0.00351558
    ## 27     1       dam       a11  0.02981496
    ## 28     1       dam        a8 -0.05653714
    ## 29     2 intercept intercept    18.08129
    ## 30     2        x1        x1   0.1267635
    ## 31     2        x2         2  -0.0512206
    ## 32     2        x2         1  -0.0183352
    ## 33     2        x3         m   -13.33161
    ## 34     2        x3         f   -14.36118
    ## 35     2        ID        a2   0.7571051
    ## 36     2        ID        a1  -0.5606095
    ## 37     2        ID        a3 -0.09611039
    ## 38     2        ID        a7  -0.6894073
    ## 39     2        ID        a4    1.622911
    ## 40     2        ID        a6   0.4318617
    ## 41     2        ID        a9    1.707714
    ## 42     2        ID        a5   -1.020498
    ## 43     2        ID       a10   -1.901942
    ## 44     2        ID       a12  -0.0836066
    ## 45     2        ID       a11 -0.09926179
    ## 46     2        ID        a8    1.913923
    ## 47     3 intercept intercept   0.1169168
    ## 48     3        x1        x1    5.481837
    ## 49     3     x1*x3    x1 * m   -6.303235
    ## 50     3     x1*x3    x1 * f   -5.454096
    ## 51     3        x2         2  -0.2348379
    ## 52     3        x2         1  0.02902851
    ## 53     3        ID        a2   0.1801575
    ## 54     3        ID        a1  -0.5563798
    ## 55     3        ID        a3   0.2665065
    ## 56     3        ID        a7  -0.5984525
    ## 57     3        ID        a4  -0.1203474
    ## 58     3        ID        a6 -0.01068671
    ## 59     3        ID        a9   0.4088791
    ## 60     3        ID        a5  -0.6344604
    ## 61     3        ID       a10  -0.7788087
    ## 62     3        ID       a12  -0.1923312
    ## 63     3        ID       a11    -0.17068
    ## 64     3        ID        a8  -0.1831543

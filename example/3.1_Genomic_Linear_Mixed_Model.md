3.1\_Genomic\_Linear\_Mixed\_Model
================
Tianjing Zhao
August 27, 2018



### Step 1: Load Package

``` r
library("JWASr")
```
Please make sure you've already set up.

### Step 2: Read data

``` r
phenotypes = phenotypes #build-in data

ped_path = "D:\\JWASr\\data\\pedigree.txt" #change to your local path
get_pedigree(ped_path, separator = ',', header = T)  #build "pedigree" in Julia
```

### Step 3: Build Model Equations

``` r
model_equation = "y1 = intercept + x1*x3 + x2 + x3 + ID + dam";
R = 1.0

build_model(model_equation,R) #build "model" in Julia
```


### Step 4: Set Factors or Covariate

``` r
set_covariate("x1")
```


### Step 5: Set Random or Fixed Effects

``` r
G1 = 1.0
set_random("x2", G1)
```


``` r
G2 = diag(2)
set_random("ID dam", G2, pedigree = TRUE)
```


### Step 6: Use Genomic Information

``` r
G3 = 1.0
geno_path = "D:/JWASr/data/genotypes.txt"  #change to your local path

add_genotypes(geno_path, G3)  #separator=',' is default
```

### Step 7: Run Bayesian Analysis

``` r
outputMCMCsamples("x2")
```

``` r
out = runMCMC(data = phenotypes, methods = "BayesC", estimatePi = TRUE, 
                     chain_length = 5000, output_samples_frequency = 100) 
out
```

    ## $`Posterior mean of polygenic effects covariance matrix`
    ##           [,1]      [,2]
    ## [1,] 2.2515918 0.3201589
    ## [2,] 0.3201589 1.7288127
    ## 
    ## $`Posterior mean of marker effects`
    ##      [,1] [,2]      
    ## [1,] "m1" -0.3528505
    ## [2,] "m2" -0.2837558
    ## [3,] "m3" 0.7387871 
    ## [4,] "m4" 0.3174194 
    ## [5,] "m5" 0.3249077 
    ## 
    ## $`Posterior mean of residual variance`
    ## [1] 1.272377
    ## 
    ## $`Posterior mean of marker effects variance`
    ## [1] 0.9280905
    ## 
    ## $`Posterior mean of location parameters`
    ##    Trait    Effect     Level    Estimate
    ## 1      1 intercept intercept    11.22084
    ## 2      1     x1*x3    x1 * m    2.056661
    ## 3      1     x1*x3    x1 * f   0.9054161
    ## 4      1        x2         2   0.2748953
    ## 5      1        x2         1  -0.2128133
    ## 6      1        x3         m   -13.91094
    ## 7      1        x3         f   -13.89881
    ## 8      1        ID        a2   0.2053027
    ## 9      1        ID        a1   0.2089958
    ## 10     1        ID        a3   -0.235355
    ## 11     1        ID        a7  0.04042069
    ## 12     1        ID        a4  -0.3907794
    ## 13     1        ID        a6  -0.1865815
    ## 14     1        ID        a9  -0.2896912
    ## 15     1        ID        a5   0.8834916
    ## 16     1        ID       a10   0.4266387
    ## 17     1        ID       a12  0.07726209
    ## 18     1        ID       a11  0.04771032
    ## 19     1        ID        a8  -0.6744953
    ## 20     1       dam        a2   0.6520092
    ## 21     1       dam        a1  -0.1223837
    ## 22     1       dam        a3  -0.1084323
    ## 23     1       dam        a7 -0.08451849
    ## 24     1       dam        a4   0.2548246
    ## 25     1       dam        a6  -0.4173132
    ## 26     1       dam        a9  0.01880938
    ## 27     1       dam        a5   0.3874218
    ## 28     1       dam       a10   0.1851588
    ## 29     1       dam       a12   0.1197191
    ## 30     1       dam       a11    0.113721
    ## 31     1       dam        a8 -0.03800705
    ## 
    ## $`Posterior mean of Pi`
    ## [1] 0.3757778

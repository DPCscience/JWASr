1.1\_Conventional\_Linear\_Mixed\_Model
================
Tianjing Zhao
August 26, 2018

### Load package

``` r
library("JWASr")
```

### build model

``` r
model_equation = "y1 = intercept + x1*x3 + x2 + x3"
R = 1.0

build_model(model_equation, R)  #build "model" in Julia
```

### data

``` r
pheno_path = "../data/pedigree.txt"
phenotypes = read.csv(pheno_path)  #build-in data
phenotypes
```

    ##     ID    y1   y2    y3  x1 x2 x3 dam
    ## 1   a1 -0.06 3.58 -1.18 0.9  2  m   0
    ## 2   a2 -0.60 4.90  0.88 0.3  1  f   0
    ## 3   a3 -2.07 3.19  0.73 0.7  2  f   0
    ## 4   a4 -2.63 6.97 -0.83 0.6  1  m  a2
    ## 5   a5  2.31 3.50 -1.52 0.4  2  m  a2
    ## 6   a6  0.93 4.87 -0.01 5.0  2  f  a3
    ## 7   a7 -0.69 3.10 -1.47 0.5  2  f  a3
    ## 8   a8 -4.69 7.31 -1.09 0.3  2  m  a6
    ## 9   a9 -2.81 7.18  0.76 0.4  2  m  a6
    ## 10 a10  1.92 1.78 -0.88 0.2  1  m  a7

### set covariate

``` r
set_covariate("x1")
```

### set random

``` r
G1 = 1.0
set_random("x2",G1)
```

### run

``` r
outputMCMCsamples("x3")
out = runMCMC(data = phenotypes, chain_length=5000, output_samples_frequency=100)
out
```

    ## $`Posterior mean of residual variance`
    ## [1] 5.480242
    ##
    ## $`Posterior mean of location parameters`
    ##   Trait    Effect     Level    Estimate
    ## 1     1 intercept intercept   -60.94357
    ## 2     1     x1*x3    x1 * m -0.02613005
    ## 3     1     x1*x3    x1 * f   0.4772402
    ## 4     1        x2         2  -0.1875421
    ## 5     1        x2         1   0.1704768
    ## 6     1        x3         m    60.04687
    ## 7     1        x3         f    59.67192

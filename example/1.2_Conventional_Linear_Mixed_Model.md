1.2\_Conventional\_Linear\_Mixed\_Model
================
Tianjing Zhao
August 26, 2018

### Install package

``` r
library(devtools)
install_github("zhaotianjing/JWASr")
```

    ## Skipping install of 'JWASr' from a github remote, the SHA1 (a15ad669) has not changed since last install.
    ##   Use `force = TRUE` to force installation

### set up (windows user)

``` r
path_libjulia = "C:/Users/ztjsw/AppData/Local/Julia-0.7.0/bin/libjulia.dll"
JWASr::jwasr_setup_win(path_libjulia)
```

    ## Julia version 0.7.0 at location C:\Users\ztjsw\AppData\Local\JULIA-~2.0\bin will be used.

    ## Loading setup script for JuliaCall...

    ## Finish loading setup script for JuliaCall.

For Mac user, run one line "JWASr::jwasr\_setup()" to setup.

### build model

``` r
model_equation ="y1 = intercept + x1 + x3
                  y2 = intercept + x1 + x2 + x3
                  y3 = intercept + x1 + x1*x3 + x2"
R = diag(3)

model = JWASr::build_model(model_equation,R)   #build "model" in Julia
```

### data

``` r
phenotypes = JWASr::phenotypes
phenotypes
```

    ##     ID    y1   y2    y3  x1 x2 x3 dam
    ## 1   a1 -0.06 3.58 -1.18 0.9  2  m   0
    ## 2   a2 -0.60 4.90  0.88 0.3  1  f   0
    ## 3   a3 -2.07 3.19  0.73 0.7  2  f   0
    ## 4   a4 -2.63 6.97 -0.83 0.6  1  m  a2
    ## 5   a5  2.31 3.50 -1.52 0.4  2  m  a2
    ## 6   a6  0.93 4.87 -0.01 5.0  2  f  a3
    ## 7   a7 -0.69 3.10 -1.47 0.5  2  f  a3
    ## 8   a8 -4.69 7.31 -1.09 0.3  2  m  a6
    ## 9   a9 -2.81 7.18  0.76 0.4  2  m  a6
    ## 10 a10  1.92 1.78 -0.88 0.2  1  m  a7

### set covariate

``` r
JWASr::ran_julia('set_covariate(model,"x1")')
```

    ## 1-element Array{Symbol,1}:
    ##  :x1

### set random

``` r
JWASr::assign("G1",diag(2))
JWASr::ran_julia('set_random(model,"x2",G1)')
```

### run

``` r
JWASr::ran_julia('outputMCMCsamples(model,"x1")')
out = JWASr::runMCMC(model, phenotypes,chain_length=5000,output_samples_frequency=100)
out
```

    ## $`Posterior mean of residual variance`
    ##            [,1]       [,2]       [,3]
    ## [1,]  4.4003725 -3.0327355 -0.6073085
    ## [2,] -3.0327355  3.4359587  0.6112263
    ## [3,] -0.6073085  0.6112263  1.0119537
    ## 
    ## $`Posterior mean of location parameters`
    ##    Trait    Effect     Level   Estimate
    ## 1      1 intercept intercept    32.8163
    ## 2      1        x1        x1  0.3671007
    ## 3      1        x3         m  -34.04473
    ## 4      1        x3         f  -33.98537
    ## 5      2 intercept intercept  -20.35181
    ## 6      2        x1        x1  0.3208344
    ## 7      2        x2         2 -0.1527287
    ## 8      2        x2         1  0.2307536
    ## 9      2        x3         m   25.35159
    ## 10     2        x3         f   23.84564
    ## 11     3 intercept intercept -0.2115442
    ## 12     3        x1        x1   9.471598
    ## 13     3     x1*x3    x1 * m  -10.48668
    ## 14     3     x1*x3    x1 * f  -9.394054
    ## 15     3        x2         2 -0.1059639
    ## 16     3        x2         1  0.1906412
